before_script:
  # Report the versions of varioius software, to make diagnosing problems
  # easier:
  - ghc --version
  - cabal --version
  - capnp --version
  - stylish-haskell --version
  - hlint --version
  # Update the hackage databse:
  - cabal update
test:alltests:
  image: zenhack/haskell-capnp-ci
  script:
      # Run the tests:
    - cabal configure --enable-tests
    - cabal install --only-dependencies
    - cabal build
    - cabal test
      # Linting:
    - ./hlint.sh
      # Run stylish-haskell, and fail if it changes anything:
    - ./format.sh
    - git diff --exit-code
